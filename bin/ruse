#!/usr/bin/env node

/** @const */
var RUSE_RC = '.ruserc';


/** Dependencies */
var package  = require('../package.json');
var config   = require('dotfile-config')(RUSE_RC);
var chalk    = require('chalk');
var program  = require('commander');
var inquirer = require('inquirer');




/** 
 * Ruse 
 */
program.version(package.version);



/**
 * Setup
 */
program
	.command('setup')
	.description('Run ruse setup/configuration wizard')
	.action(function(env) {
		console.log(chalk.bold.underline('Setting up Ruse:'));
		
		inquirer.prompt([
			{
				type:    'input',
				name:    'aws_access_key_id',
				message: 'AWS Access Key ID:'
			},
			{
				type:    'input',
				name:    'secret_access_key',
				message: 'AWS Secret Access key:'
			},
			{
				type:    'input',
				name:    'cloudflare_api_key',
				message: 'CloudFlare API Key:'
			},
			{
				type:    'input',
				name:    'root_domain',
				message: 'Root app domain:'
			}
		], function(response) {
			console.log();
			config.set(response);
			
			console.log(chalk.bold.green('Configured!'));
		});
	});



/**
 * Configure
 */
program
	.command('configure')
	.description('Configure ruse settings')
	.action(function(env) {
		console.log('Configuring!');
		console.log(config.get());
	});



/**
 * Deploy
 */
program
	.command('deploy')
	.description('Deploy to s3')
	.action(function(env) {
		console.log('Deploying!');
	});



/** Parse */
program.parse(process.argv);